import videojs from"video.js";const Plugin=videojs.getPlugin("plugin");class Hotkeys extends Plugin{constructor(e,t){super(e);var r=e.el(),o=document,n={volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableHoverScroll:!1,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!0,captureDocumentHotkeys:!1,documentHotkeysFocusElementFilter:function(){return!1},enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:H,rewindKey:M,forwardKey:P,volumeUpKey:x,volumeDownKey:I,muteKey:R,fullscreenKey:N,customKeys:{}};videojs.options.blockKeys=!1;var i=1,l=2,u=3,a=4,s=5,c=6,f=7,y=videojs.mergeOptions||videojs.util.mergeOptions;t=y(n,t||{});e.on("dispose",function(){document.removeEventListener("keydown",T);e.off("keydown",T);e.off("dblclick",q);e.off("mousewheel",D);e.off("DOMMouseScroll",D)});var m=t.volumeStep,v=t.seekStep,b=t.enableMute,p=t.enableVolumeScroll,d=t.enableFullscreen,k=t.enableNumbers,h=t.enableJogStyle,w=t.alwaysCaptureHotkeys,K=t.captureDocumentHotkeys,S=t.documentHotkeysFocusElementFilter,g=t.enableModifiersForNumbers,F=t.enableInactiveFocus,j=t.skipInitialFocus;if(!r.hasAttribute("tabIndex"))r.setAttribute("tabIndex","-1");r.style.outline="none";if(w||!e.autoplay())if(!j)e.one("play",function(){r.focus()});if(F)e.on("userinactive",function(){var t=function(){clearTimeout(n)},n=setTimeout(function(){e.off("useractive",t);var n=o.activeElement,i=r.querySelector(".vjs-control-bar");if(n&&n.parentElement===i)r.focus()},10);e.one("useractive",t)});e.on("play",function(){var e=r.querySelector(".iframeblocker");if(e&&""===e.style.display){e.style.display="block";e.style.bottom="39px"}});var T=function(n){var y,p=n.which;if(e.controls()){var F=o.activeElement;if(w||(K&&S(F))||F===r||F===r.querySelector(".vjs-tech")||F===r.querySelector(".vjs-control-bar")||F===r.querySelector(".iframeblocker")){n.preventDefault();if(n.stopPropagation)n.stopPropagation();else if(window.event)window.event.cancelBubble=!0;var j=e.playbackRates();if(n.shiftKey&&188===p){j.sort(function(e,t){return t-e});for(var T=0;T<j.length;T++)if(j[T]<e.playbackRate()){e.setRate(j[T]);break}}if(n.shiftKey&&190===p){j.sort(function(e,t){return e-t});for(T=0;T<j.length;T++)if(j[T]>e.playbackRate()){e.setRate(j[T]);break}}switch(E(n,e)){case i:if(e.paused())e.play();else e.pause();break;case l:if(videojs.options.blockKeys)break;y=e.currentTime()-v;if(e.currentTime()<=v)y=0;e.currentTime(y);break;case u:if(videojs.options.blockKeys)break;e.currentTime(e.currentTime()+v);break;case s:n.stopPropagation();if(videojs.options.blockKeys)break;if(!h)e.volume(e.volume()-m);else{y=e.currentTime()-1;if(e.currentTime()<=1)y=0;e.currentTime(y)}break;case a:if(videojs.options.blockKeys)break;if(!h)e.volume(e.volume()+m);else e.currentTime(e.currentTime()+1);break;case c:if(b)e.muted(!e.muted());break;case f:n.preventDefault();n.stopPropagation();if(d)if(e.isFullscreen())e.exitFullscreen();else e.requestFullscreen();break;default:if((p>47&&p<59)||(p>95&&p<106))if(g||!(n.metaKey||n.ctrlKey||n.altKey))if(k){var q=48;if(p>95)q=96;var D=p-q;n.preventDefault();e.currentTime(e.duration()*D*.1)}for(var H in t.customKeys){var M=t.customKeys[H];if(M&&M.key&&M.handler)if(M.key(n)){n.preventDefault();M.handler(e,t)}}}}}},q=function(t){if(e.controls()){var n=t.relatedTarget||t.toElement||o.activeElement;if(n===r||n===r.querySelector(".vjs-tech")||n===r.querySelector(".iframeblocker"))if(d)if(e.isFullscreen())e.exitFullscreen();else e.requestFullscreen()}},D=function(t){if(e.controls()){var n=t.relatedTarget||t.toElement||o.activeElement;if(w||n===r||n===r.querySelector(".vjs-tech")||n===r.querySelector(".iframeblocker")||n===r.querySelector(".vjs-control-bar"))if(p){t=window.event||t;var i=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));t.preventDefault();if(1===i)e.volume(e.volume()+m);else if(-1===i)e.volume(e.volume()-m)}}},E=function(e,r){if(t.playPauseKey(e,r))return i;if(t.rewindKey(e,r))return l;if(t.forwardKey(e,r))return u;if(t.volumeUpKey(e,r))return a;if(t.volumeDownKey(e,r))return s;if(t.muteKey(e,r))return c;if(t.fullscreenKey(e,r))return f};function H(e){return 32===e.which||179===e.which}function M(e){return 37===e.which||177===e.which}function P(e){return 39===e.which||176===e.which}function x(e){return 38===e.which}function I(e){return 40===e.which}function R(e){return 77===e.which}function N(e){return 70===e.which}document.addEventListener("keydown",T,!1);e.on("keydown",T);e.on("dblclick",q);e.on("mousewheel",D);e.on("DOMMouseScroll",D);return this}}videojs.registerPlugin("hotkeys",Hotkeys);export default Hotkeys;
